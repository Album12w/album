<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explorador de Carpetas</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
</head>
<body>
 <style>
       body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        header {
            background-color: #333;
            color: white;
            text-align: center;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .container {
            flex-grow: 1;
            overflow: hidden;
        }

        .folder-list, .media-gallery {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            padding: 0 10px;
            transition: all 0.3s ease-in-out;
        }

        .folder-card, .gallery-card {
            width: 45%; /* Dos por fila en dispositivos móviles */
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            overflow: hidden;
            transition: transform 0.2s ease-in-out;
        }

        .folder-card:hover, .gallery-card:hover {
            transform: scale(1.05);
        }

        .folder-card img, .gallery-card img, .gallery-card video {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
        }

        /* Pantallas grandes: tres por fila */
        @media (min-width: 768px) {
            .folder-card, .gallery-card {
                width: 30%;
            }
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
            z-index: 999;
        }

        .modal img, .modal video {
            max-width: 80%;
            max-height: 80%;
        }

        .modal .close {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            font-size: 30px;
            cursor: pointer;
        }

        .pagination-container {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }

        .page-button {
            padding: 12px;
            margin: 0 10px;
            cursor: pointer;
            background-color: #333;
            color: white;
            border-radius: 50%;
            border: none;
            font-size: 18px;
        }

        .page-button:hover {
            background-color: #555;
        }

        .back-button {
            padding: 10px 20px;
            margin-top: 20px;
            background-color: #333;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .back-button:hover {
            background-color: #555;
        }
    </style>
<header>
    <h1>Album Familiar</h1>
    <p>Desarrollado por Kobayashi Dev.</p>
</header>

<div class="container">
    <div id="folderList" class="folder-list">
        <!-- Aquí se cargarán las carpetas -->
    </div>

    <div id="mediaGallery" class="media-gallery" style="display: none;">
        <!-- Aquí se cargarán las imágenes y videos -->
    </div>

   

    <button class="back-button" id="backButton" style="display:none;" onclick="goBack()">Volver Atrás</button>
</div>

<!-- Modal para imágenes y videos -->
<div class="modal" id="mediaModal">
    <span class="close" id="closeModal">&times;</span>
    <div id="modalMediaContainer"></div>
</div>

<script>
    const apiUrl = 'https://huggingface.co/api/models/CineMax/gdrivelatino/tree/main'; // URL de la API
    let currentFolder = null;
    let files = []; // Archivos de la carpeta actual
    let folders = []; // Carpetas obtenidas
    let currentPage = 1;
    const itemsPerPage = 5;

    // Función para obtener las carpetas desde la API
    async function fetchFolders() {
        try {
            const response = await fetch(apiUrl);
            const data = await response.json();

            // Filtrar las carpetas y archivos
            const directories = data.filter(item => item.type === 'directory');
            displayFolders(directories);
        } catch (error) {
            console.error("Error al obtener las carpetas:", error);
        }
    }

    // Función para mostrar las carpetas
    function displayFolders(folders) {
        const folderList = document.getElementById('folderList');
        folderList.innerHTML = ''; // Limpiar las carpetas previas

        folders.forEach(folder => {
            const folderCard = document.createElement('div');
            folderCard.classList.add('folder-card');
            const folderIcon = document.createElement('img');
            folderIcon.src = "https://raw.githubusercontent.com/Album12w/album/refs/heads/main/folder.png"; // Icono de carpeta
            folderCard.appendChild(folderIcon);
            folderCard.innerHTML += `<p>${folder.path}</p>`;
            folderCard.addEventListener('click', () => openFolder(folder));

            folderList.appendChild(folderCard);
        });
    }

    // Función para abrir una carpeta y cargar los archivos
    async function openFolder(folder) {
        currentFolder = folder.path;
        const folderUrl = `https://huggingface.co/api/models/CineMax/gdrivelatino/tree/main/${folder.path}`;
        const response = await fetch(folderUrl);
        const data = await response.json();

        // Filtrar los archivos y subcarpetas dentro de la carpeta
        const subfolders = data.filter(item => item.type === 'directory');
        files = data.filter(item => item.type === 'file');
        displayFolders(subfolders); // Mostrar subcarpetas
        displayFiles(); // Mostrar archivos multimedia

        // Mostrar contenido de las carpetas
        document.getElementById('folderList').style.display = 'flex';
        document.getElementById('mediaGallery').style.display = 'flex';
        document.getElementById('backButton').style.display = 'inline-block';

        // Configurar la paginación
        configurePagination();
    }

    // Función para mostrar los archivos de la carpeta
    function displayFiles() {
        const mediaGallery = document.getElementById('mediaGallery');
        mediaGallery.innerHTML = '';  // Limpiar galería de medios

        // Paginación: calcular qué archivos mostrar
        const startIndex = (currentPage - 1) * itemsPerPage;
        const paginatedFiles = files.slice(startIndex, startIndex + itemsPerPage);

        paginatedFiles.forEach(file => {
            const fileCard = document.createElement('div');
            fileCard.classList.add('gallery-card');
            const fileExtension = file.path.split('.').pop().toLowerCase();

            if (['jpg', 'jpeg', 'png', 'gif'].includes(fileExtension)) {
                const img = document.createElement('img');
                img.src = `https://huggingface.co/CineMax/gdrivelatino/resolve/main/${file.path}`;
                img.alt = "Imagen";
                img.addEventListener('click', () => openModal(file.path));
                fileCard.appendChild(img);
                mediaGallery.appendChild(fileCard);
            } else if (['mp4', 'mov', 'avi'].includes(fileExtension)) {
                const video = document.createElement('video');
                video.src = `https://huggingface.co/CineMax/gdrivelatino/resolve/main/${file.path}`;
                video.controls = true;
                video.addEventListener('click', () => openModal(file.path));
                fileCard.appendChild(video);
                mediaGallery.appendChild(fileCard);
            }
        });
    }

    // Función para abrir el modal con la imagen o video
    function openModal(filePath) {
        const modal = document.getElementById('mediaModal');
        const modalMediaContainer = document.getElementById('modalMediaContainer');
        const fileExtension = filePath.split('.').pop().toLowerCase();

        modal.style.display = 'flex';

        if (['jpg', 'jpeg', 'png', 'gif'].includes(fileExtension)) {
            const img = document.createElement('img');
            img.src = `https://huggingface.co/CineMax/gdrivelatino/resolve/main/${filePath}`;
            modalMediaContainer.innerHTML = '';  // Limpiar el contenido anterior
            modalMediaContainer.appendChild(img);
        } else if (['mp4', 'mov', 'avi'].includes(fileExtension)) {
            const video = document.createElement('video');
            video.src = `https://huggingface.co/CineMax/gdrivelatino/resolve/main/${filePath}`;
            video.controls = true;
            modalMediaContainer.innerHTML = '';  // Limpiar el contenido anterior
            modalMediaContainer.appendChild(video);
        }
    }

    // Función para cerrar el modal
    document.getElementById('closeModal').addEventListener('click', () => {
        const modal = document.getElementById('mediaModal');
        modal.style.display = 'none';
    });

    // Función para volver atrás
    function goBack() {
        document.getElementById('folderList').style.display = 'flex';
        document.getElementById('mediaGallery').style.display = 'none';
        document.getElementById('backButton').style.display = 'none';
        displayFolders([]);
        displayFiles([]);
    }

    // Función para configurar la paginación
    function configurePagination() {
        const paginationContainer = document.getElementById('pagination');
        paginationContainer.innerHTML = ''; // Limpiar la paginación anterior

        const totalPages = Math.ceil(files.length / itemsPerPage);

        if (totalPages > 1) {
            for (let i = 1; i <= totalPages; i++) {
                const pageButton = document.createElement('button');
                pageButton.classList.add('page-button');
                pageButton.textContent = i;
                pageButton.addEventListener('click', () => changePage(i));

                paginationContainer.appendChild(pageButton);
            }

            paginationContainer.style.display = 'flex';
        }
    }

    // Función para cambiar de página
    function changePage(pageNumber) {
        currentPage = pageNumber;
        displayFiles();
    }

    // Agregar la funcionalidad de deslizar en dispositivos móviles
    let touchStartX = 0;

    document.getElementById('mediaGallery').addEventListener('touchstart', (e) => {
        touchStartX = e.touches[0].clientX;
    });

    document.getElementById('mediaGallery').addEventListener('touchend', (e) => {
        const touchEndX = e.changedTouches[0].clientX;

        if (touchStartX - touchEndX > 50) {
            // Deslizar hacia la izquierda
            if (currentPage < Math.ceil(files.length / itemsPerPage)) {
                changePage(currentPage + 1);
            }
        } else if (touchEndX - touchStartX > 50) {
            // Deslizar hacia la derecha
            if (currentPage > 1) {
                changePage(currentPage - 1);
            }
        }
    });

    // Iniciar carga de carpetas cuando se cargue la página
    window.onload = fetchFolders;
</script>

</body>
</html>
